<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QTI Generator</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>QTI Generator for Canvas LMS</h1>
            <div class="toolbar">
                <button id="newAssessment" class="btn btn-primary">New Assessment</button>
                <button id="saveAssessment" class="btn btn-secondary">Save</button>
                <button id="exportQTI" class="btn btn-success">Export QTI</button>
            </div>
        </header>

        <main>
            <!-- AI Generation Section -->
            <div class="ai-generation-section">
                <h2>AI Question Generation</h2>
                <div class="ai-controls">
                    <div class="form-group">
                        <label for="pdfUpload">Upload PDF or Enter Text:</label>
                        <div class="upload-area">
                            <input type="file" id="pdfUpload" accept=".pdf" style="display: none;">
                            <button id="uploadBtn" class="btn btn-secondary">Choose PDF File</button>
                            <span id="fileName" class="file-name"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="contextText">Or Enter Text Context:</label>
                        <textarea id="contextText" placeholder="Enter the content/context for question generation..." rows="6"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="questionCount">Number of Questions:</label>
                        <input type="number" id="questionCount" value="5" min="1" max="20">
                    </div>
                    <div class="form-group">
                        <label for="difficultyLevel">Difficulty Level:</label>
                        <select id="difficultyLevel">
                            <option value="easy">Easy</option>
                            <option value="medium">Medium</option>
                            <option value="hard">Hard</option>
                            <option value="mixed">Mixed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="questionTypes">Question Types:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" value="multiple_choice" checked> Multiple Choice</label>
                            <label><input type="checkbox" value="true_false"> True/False</label>
                            <label><input type="checkbox" value="short_answer"> Short Answer</label>
                            <label><input type="checkbox" value="essay"> Essay</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="includeMath" checked>
                            Include LaTeX math notation for mathematical content
                        </label>
                    </div>
                    <button id="generateQuestions" class="btn btn-primary">Generate Questions with AI</button>
                </div>
            </div>

            <div class="assessment-details">
                <h2>Assessment Details</h2>
                <div class="form-group">
                    <label for="assessmentTitle">Title:</label>
                    <input type="text" id="assessmentTitle" placeholder="Enter assessment title">
                </div>
                <div class="form-group">
                    <label for="assessmentDescription">Description:</label>
                    <textarea id="assessmentDescription" placeholder="Enter assessment description"></textarea>
                </div>
                <div class="form-group">
                    <label for="timeLimit">Time Limit (minutes):</label>
                    <input type="number" id="timeLimit" placeholder="0 for no limit">
                </div>
            </div>

            <!-- Settings Section -->
            <div class="settings-section">
                <h2>LLM Configuration</h2>
                <div class="settings-controls">
                    <div class="form-group">
                        <label for="llmProvider">LLM Provider:</label>
                        <select id="llmProvider">
                            <option value="gemini">Google Gemini (Recommended)</option>
                            <option value="openai">OpenAI GPT</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="apiKey">API Key:</label>
                        <input type="password" id="apiKey" placeholder="Enter your API key">
                        <small>Get your free API key from <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></small>
                    </div>
                </div>
            </div>

            <div class="questions-section">
                <div class="questions-header">
                    <h2>Questions</h2>
                    <div class="question-controls">
                        <select id="questionType">
                            <option value="multiple_choice">Multiple Choice</option>
                            <option value="true_false">True/False</option>
                            <option value="short_answer">Short Answer</option>
                            <option value="essay">Essay</option>
                            <option value="fill_in_blank">Fill in the Blank</option>
                        </select>
                        <button id="addQuestion" class="btn btn-primary">Add Question</button>
                    </div>
                </div>
                
                <div id="questionsContainer">
                    <!-- Questions will be dynamically added here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Question Templates -->
    <template id="multipleChoiceTemplate">
        <div class="question-item" data-type="multiple_choice">
            <div class="question-header">
                <span class="question-number"></span>
                <button class="btn-remove">×</button>
            </div>
            <div class="question-content">
                <div class="form-group">
                    <label>Question Text:</label>
                    <textarea class="question-text" placeholder="Enter your question (LaTeX supported: use $ for inline math, $$ for display math)"></textarea>
                    <div class="math-preview"></div>
                </div>
                <div class="form-group">
                    <label>Points:</label>
                    <input type="number" class="question-points" value="1" min="0">
                </div>
                <div class="choices-container">
                    <label>Answer Choices:</label>
                    <div class="choice-item">
                        <input type="radio" name="correct-choice" value="0">
                        <input type="text" class="choice-text" placeholder="Choice A (LaTeX supported)">
                        <button class="btn-remove-choice">×</button>
                    </div>
                    <div class="choice-item">
                        <input type="radio" name="correct-choice" value="1">
                        <input type="text" class="choice-text" placeholder="Choice B (LaTeX supported)">
                        <button class="btn-remove-choice">×</button>
                    </div>
                    <button class="btn-add-choice">Add Choice</button>
                </div>
            </div>
        </div>
    </template>

    <template id="trueFalseTemplate">
        <div class="question-item" data-type="true_false">
            <div class="question-header">
                <span class="question-number"></span>
                <button class="btn-remove">×</button>
            </div>
            <div class="question-content">
                <div class="form-group">
                    <label>Question Text:</label>
                    <textarea class="question-text" placeholder="Enter your question (LaTeX supported: use $ for inline math, $$ for display math)"></textarea>
                    <div class="math-preview"></div>
                </div>
                <div class="form-group">
                    <label>Points:</label>
                    <input type="number" class="question-points" value="1" min="0">
                </div>
                <div class="form-group">
                    <label>Correct Answer:</label>
                    <select class="correct-answer">
                        <option value="true">True</option>
                        <option value="false">False</option>
                    </select>
                </div>
            </div>
        </div>
    </template>

    <template id="shortAnswerTemplate">
        <div class="question-item" data-type="short_answer">
            <div class="question-header">
                <span class="question-number"></span>
                <button class="btn-remove">×</button>
            </div>
            <div class="question-content">
                <div class="form-group">
                    <label>Question Text:</label>
                    <textarea class="question-text" placeholder="Enter your question (LaTeX supported: use $ for inline math, $$ for display math)"></textarea>
                    <div class="math-preview"></div>
                </div>
                <div class="form-group">
                    <label>Points:</label>
                    <input type="number" class="question-points" value="1" min="0">
                </div>
                <div class="form-group">
                    <label>Sample Answer (optional):</label>
                    <textarea class="sample-answer" placeholder="Enter a sample answer for grading reference"></textarea>
                </div>
            </div>
        </div>
    </template>

    <template id="essayTemplate">
        <div class="question-item" data-type="essay">
            <div class="question-header">
                <span class="question-number"></span>
                <button class="btn-remove">×</button>
            </div>
            <div class="question-content">
                <div class="form-group">
                    <label>Question Text:</label>
                    <textarea class="question-text" placeholder="Enter your question (LaTeX supported: use $ for inline math, $$ for display math)"></textarea>
                    <div class="math-preview"></div>
                </div>
                <div class="form-group">
                    <label>Points:</label>
                    <input type="number" class="question-points" value="5" min="0">
                </div>
                <div class="form-group">
                    <label>Grading Rubric (optional):</label>
                    <textarea class="grading-rubric" placeholder="Enter grading criteria"></textarea>
                </div>
            </div>
        </div>
    </template>

    <script src="renderer.js"></script>
</body>
</html>